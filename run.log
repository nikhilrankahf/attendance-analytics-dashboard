=== ENHANCED ATTENDANCE FORECASTING WITH GREYKITE (OLD CSV SCHEMA) ===

✓ Loaded data: 5391 records from /Users/nikhil.ranka/attendance-analytics-dashboard/Labor_Management-Greykite_Input.csv
Available columns: ['WEEK_NUMBER', 'WORK_LOCATION', 'SHIFT_TIME', 'DEPARTMENT_GROUP', 'WEEKLY_ATTENDANCE_RATE', 'FOUR_WEEK_ROLLING_AVG', 'SIX_WEEK_ROLLING_AVG', 'EXPONENTIAL_SMOOTHING_0_2', 'EXPONENTIAL_SMOOTHING_0_4', 'EXPONENTIAL_SMOOTHING_0_6', 'EXPONENTIAL_SMOOTHING_0_8', 'EXPONENTIAL_SMOOTHING_1']
Using actuals column: 'WEEKLY_ATTENDANCE_RATE'

Applying segment filters:
  WORK_LOCATION == NJ Newark Lister Ave -> 886 rows
  SHIFT_TIME == PM -> 443 rows
  DEPARTMENT_GROUP == Production -> 194 rows

Forecast targets constrained to weeks >= 2025-W28 (start date 2025-07-10)

Grouping by: ['WORK_LOCATION', 'SHIFT_TIME', 'DEPARTMENT_GROUP']

Processing: NJ Newark Lister Ave - PM - Production
Data points: 194
    Greykite for 2025-W28 using 180 weeks up to 2025-W26 (gap=1)
    Greykite for 2025-W29 using 181 weeks up to 2025-W27 (gap=1)
    Greykite for 2025-W30 using 182 weeks up to 2025-W28 (gap=1)
    Greykite for 2025-W31 using 183 weeks up to 2025-W29 (gap=1)
    Greykite for 2025-W32 using 184 weeks up to 2025-W30 (gap=1)
    Greykite for 2025-W33 using 185 weeks up to 2025-W31 (gap=1)
    Greykite for 2025-W34 using 186 weeks up to 2025-W32 (gap=1)
    Greykite for 2025-W35 using 187 weeks up to 2025-W33 (gap=1)
    Greykite for 2025-W36 using 188 weeks up to 2025-W34 (gap=1)
    Greykite for 2025-W37 using 189 weeks up to 2025-W35 (gap=1)
    Greykite for 2025-W38 using 190 weeks up to 2025-W36 (gap=1)
    Greykite for 2025-W39 using 191 weeks up to 2025-W37 (gap=1)
    Greykite for 2025-W40 using 192 weeks up to 2025-W38 (gap=1)
  Greykite MAE: 16.4454 | Shifted MA(4) MAE: 1.8237

✓ Enhanced forecasts saved to: enhanced_attendance_forecast_all_combinations_2024_2025_20250929_213214.csv
  Records: 13
  Columns: ['week_number', 'work_location', 'shift_time', 'department_group', 'actual_attendance', 'greykite_forecast', 'greykite_forecast_lower_95', 'greykite_forecast_upper_95', 'four_week_rolling_avg', 'six_week_rolling_avg', 'exponential_smoothing_alpha_2', 'exponential_smoothing_alpha_4', 'exponential_smoothing_alpha_6', 'exponential_smoothing_alpha_8', 'exponential_smoothing_alpha_1', 'four_week_rolling_avg_shift2']
  Segments processed successfully: 1

=== DONE ===
